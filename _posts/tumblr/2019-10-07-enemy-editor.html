---
layout: post
title: Enemy Editor
date: '2019-10-07T21:28:58-04:00'
tags:
- colonycaseus
tumblr_url: https://boxfishdev.tumblr.com/post/188203650619/enemy-editor
---
<p>To my complete surprise, I wasn’t able to finish the rest of Colony Caseus in a week. In all seriousness, given the stuff I need to put in, plus my schedule in general, it probably won’t be ready to test for another month or so. During the week, I’ve been working on setting up the combat system. Prior to this, I was focused a lot more on item collection, puzzle solving, and exploration, so it wasn’t like I could just slide in something real quickly. Since your skill at fighting means life or death, I needed to make sure shooting enemies felt natural, but not too easy. It’s pretty buggy and unpolished at the moment, but here’s a little sample of how combat looks in game:</p><figure class="tmblr-full" data-orig-height="388" data-orig-width="700"><img src="https://66.media.tumblr.com/fd8f254df11e3ce2f88935620f7e512d/2314bd022d758969-b7/s540x810/c988260641ae8cea1d00f5e1d2465b946346df08.gif" data-orig-height="388" data-orig-width="700"/></figure><p>Once I finish up with the combat system, I’ll cover it in more depth. For now, I want to turn your attention towards the little things I’m shooting at. When creating an enemy, there are a lot of attributes that you have to define:<br/></p><ul><li>How much health they have<br/></li><li>Where their hitbox is</li><li>How they move around<br/></li><li>What animations they should use</li><li>&hellip;etc</li></ul><div><p>If there’s one thing I’ve learned about mixing creativity with programming, it’s that the less you have to worry about the code itself, the better the final product. So hardcoding enemy logic directly into the game was a no go. To make prototyping a variety of enemies easy, enemy data would have to be stored in files that the engine would load at runtime.</p><p>My first crack at the problem was to create an asset file with the following properties:</p><ul><li>Enemy ID</li><li>Health</li><li>Hitbox data (x, y, width, height)</li><li>Animation file name (defines what spritesheet to use and animations)</li><li><p>Script name (defines enemy behavior)<br/></p></li></ul><p>Unfortunately, I ran into a big problem really quickly. Defining my enemies like this meant that I couldn’t change my hitbox or offset on a frame by frame basis. For example, if I had an armored enemy that was only vulnerable when it took off its armor, I’d have to have the hitbox increase in size as the armor comes off.<br/></p></div><figure class="tmblr-full" data-orig-height="153" data-orig-width="430"><img src="https://66.media.tumblr.com/8ad0b24be0802a49fab94542ce5b4b83/2314bd022d758969-37/s540x810/d006c6cdfa0c2017da677d909863575281c1b2ca.png" data-orig-height="153" data-orig-width="430"/></figure><p>So instead of reusing my current sprite animation tool, I had to create my own enemy editor. <br/></p><figure class="tmblr-full" data-orig-height="513" data-orig-width="981"><img src="https://66.media.tumblr.com/d44c5d897fe2d4e6b658a8345ce1f078/2314bd022d758969-52/s540x810/713b363bcfa43c978df47b62e4620140dfb606c9.png" data-orig-height="513" data-orig-width="981"/></figure><p>It’s mostly a frame selecting animation tool: you open up a spritesheet, create a new animation entry, and select the sprites that make up each frame of the animation. However, unlike a normal animation editor, I can also define the offset and hitbox of a move on a frame by frame basis.<br/></p><figure class="tmblr-full" data-orig-height="504" data-orig-width="972"><img src="https://66.media.tumblr.com/b37efb580adaa0fa4cb100bc1aa2e5f3/2314bd022d758969-c2/s540x810/131645c004b0dbb471d5de215bffde71148352a7.gif" data-orig-height="504" data-orig-width="972"/></figure><p>The offset tab lets me control where the enemy is relative to the tile it’s on. For example, if I have an enemy that jumps from tile to tile, I can create the jumping animation, define which frames I’m using, then define the offsets so that at the end of the animation, the enemy is at the target tile.</p><figure class="tmblr-full" data-orig-height="506" data-orig-width="980"><img src="https://66.media.tumblr.com/f6fc786f6ae6abd80065d013f4ac0b3b/2314bd022d758969-f5/s540x810/508bc05562efc7a7b725fc96f749a23073a107ed.gif" data-orig-height="506" data-orig-width="980"/></figure><p>The hitbox tab lets me control the position and size of the hitbox. Going back to the armored enemy example, for animations with armor on, the hitbox would be undefined or really small. Then, for unarmored animations, I’d define a hitbox at the weak spot. Another example is an enemy that jerks back and forth and has a weak spot on their head. Thanks to the editor, it’s really easy to go through every animation and select just the head.</p><p>If you’re wondering how I define enemy behavior, it’s just an external script with four functions. One activates when the enemy spawns, so things like health can be defined. One activates every frame, so you can do things like chase after the player or activate an idle animation if no combat happens for a long time. One activates when the player moves, to make player detection easier and more efficient. And finally, one activates whenever the player shoots it, so it knows to die and trigger a death animation after a certain number of hits.</p><p>So that’s how enemies are created in Colony Caseus. I’ll probably change a couple things as I work with the system, but so far, I’m pretty happy with how things work. <br/></p>
